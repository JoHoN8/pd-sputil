{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 076208952c7af5d614bf","webpack:///external {\"commonjs\":\"jquery\",\"commonjs2\":\"jquery\",\"amd\":\"jquery\",\"root\":\"$\"}","webpack:///./src/library.js"],"names":["spSaveForm","domReady","getDataType","elementTagName","argsConverter","arrayInsertAtIndex","arrayRemoveAtIndex","encodeAccountName","promiseDelay","exportToCSV","getPageInfo","spGotoUrl","spSearchResultsCleaner","pageEditModeTest","hideRibbon","URLparameters","waitForScriptsReady","tableRowLoop","loadSPScript","$","require","processRow","row","finalVal","j","length","innerValue","toString","Date","toLocaleString","result","replace","search","ready","obj","readyFired","i","readyList","fn","call","window","ctx","readyStateChange","document","readyState","profileProps","formId","saveButtonValue","PreSaveItem","SPClientForms","ClientFormManager","SubmitClientForm","WebForm_DoPostBackWithOptions","WebForm_PostBackOptions","callback","context","readyEventHandlersInstalled","TypeError","setTimeout","push","attachEvent","addEventListener","item","Object","prototype","match","toLowerCase","element","ele","prop","tagName","args","startAt","giveBack","numberToStartAt","total","array","index","arrayToInsert","Array","splice","apply","arguments","concat","acctName","check","formattedName","test","encodeURIComponent","time","def","Deferred","amount","resolve","promise","sesStorage","storageAdaptor","sessionStorage","key","getItem","JSON","parse","e","value","type","toType","stringify","setItem","removeItem","sublish","cache","id","ii","filename","rows","csvFile","blob","Blob","navigator","msSaveBlob","link","createElement","download","undefined","url","URL","createObjectURL","setAttribute","style","visibility","body","appendChild","click","removeChild","_spPageContextInfo","STSNavigate","results","neededProps","Error","cleanProps","properties","totalItems","map","Cells","indexOf","Key","Value","val","ribbon","getElementById","currentHeight","parseInt","height","display","SelectRibbonTab","params","pairs","pair","parts","split","decodeURIComponent","slice","join","parastring","location","substr","scriptName","ExecuteOrDelayUntilScriptLoaded","table","cb","children","totalRows","$row","fileName","getScript"],"mappings":"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","file":"pd-sputil.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"jquery\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"jquery\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"pdsputil\"] = factory(require(\"jquery\"));\n\telse\n\t\troot[\"pdsputil\"] = factory(root[\"$\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_0__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 076208952c7af5d614bf","module.exports = __WEBPACK_EXTERNAL_MODULE_0__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"commonjs\":\"jquery\",\"commonjs2\":\"jquery\",\"amd\":\"jquery\",\"root\":\"$\"}\n// module id = 0\n// module chunks = 0","/**\r\n    app name sputil\r\n */\r\nvar $ = require('jquery');\r\n\r\nconst processRow = function (row) {\r\n    var finalVal = '';\r\n    for (var j = 0; j < row.length; j++) {\r\n        var innerValue = row[j] === null ? '' : row[j].toString();\r\n        if (row[j] instanceof Date) {\r\n            innerValue = row[j].toLocaleString();\r\n        }\r\n        var result = innerValue.replace(/\"/g, '\"\"');\r\n        if (result.search(/(\"|,|\\n)/g) >= 0) {\r\n            result = '\"' + result + '\"';\r\n        }\r\n        if (j > 0) {\r\n            finalVal += ',';\r\n        }\r\n        finalVal += result;\r\n    }\r\n    return finalVal + '\\r\\n';\r\n};\r\nconst ready = function(obj) {\r\n    if (!obj.readyFired) {\r\n        // this must be set to true before we start calling callbacks\r\n        obj.readyFired = true;\r\n        for (var i = 0; i < obj.readyList.length; i++) {\r\n            // if a callback here happens to add new ready handlers,\r\n            // the docReady() function will see that it already fired\r\n            // and will schedule the callback to run right after\r\n            // this event loop finishes so all handlers will still execute\r\n            // in order and no new ones will be added to the readyList\r\n            // while we are processing the list\r\n            obj.readyList[i].fn.call(window, obj.readyList[i].ctx);\r\n        }\r\n        obj.readyList = [];\r\n    }\r\n};\r\n\r\nconst readyStateChange = function() {\r\n    if ( document.readyState === \"complete\" ) {\r\n        ready();\r\n    }\r\n};\r\nexport const profileProps = ['PreferredName','SPS-JobTitle','WorkPhone','OfficeNumber',\r\n    'WorkEmail','doeaSpecialAccount','SPS-Department','AccountName','SPS-Location',\r\n    'PositionID','Manager','Office', \"LastName\", \"FirstName\"];\r\n\r\n\r\n/**\r\n     * Saves SP out of the box form Dispform, Editform, Newform\r\n     * @param {string} [formId]\r\n     * @param {string} saveButtonValue\r\n     * @returns {void}\r\n*/\r\nexport function spSaveForm(formId, saveButtonValue) {\r\n    if (!PreSaveItem()) {return false;}\r\n    if (formId && SPClientForms.ClientFormManager.SubmitClientForm(formId)) {return false;}\r\n    WebForm_DoPostBackWithOptions(new WebForm_PostBackOptions(saveButtonValue, \"\", true, \"\", \"\", false, true));\r\n}\r\n/**\r\n     * Invokes the callback when dom is ready\r\n     * context is passed to the call back as first parameter\r\n     * @param {function} callback\r\n     * @param {object} context\r\n     * @returns {void}\r\n*/\r\nexport function domReady(callback, context) {\r\n    \r\n    let obj = {\r\n        readyList: [],\r\n        readyFired: false,\r\n        readyEventHandlersInstalled: false\r\n    };\r\n\r\n    if (typeof callback !== \"function\") {\r\n        throw new TypeError(\"callback for docReady(fn) must be a function\");\r\n    }\r\n    // if ready has already fired, then just schedule the callback\r\n    // to fire asynchronously, but right away\r\n    if (obj.readyFired) {\r\n        setTimeout(() => {\r\n            callback(context);\r\n        }, 1);\r\n        return;\r\n    } else {\r\n        // add the function and context to the list\r\n        obj.readyList.push({fn: callback, ctx: context});\r\n    }\r\n    // if document already ready to go, schedule the ready function to run\r\n    // IE only safe when readyState is \"complete\", others safe when readyState is \"interactive\"\r\n    if (document.readyState === \"complete\" || (!document.attachEvent && document.readyState === \"interactive\")) {\r\n        setTimeout(() => {\r\n            ready(obj);\r\n        }, 1);\r\n    } else if (!obj.readyEventHandlersInstalled) {\r\n        // otherwise if we don't have event handlers installed, install them\r\n        if (document.addEventListener) {\r\n            // first choice is DOMContentLoaded event\r\n            document.addEventListener(\"DOMContentLoaded\", () => {\r\n                ready(obj);\r\n            }, false);\r\n            // backup is window load event\r\n            window.addEventListener(\"load\", () => {\r\n                ready(obj);\r\n            }, false);\r\n        } else {\r\n            // must be IE\r\n            document.attachEvent(\"onreadystatechange\", readyStateChange);\r\n            window.attachEvent(\"onload\", () => {\r\n                ready(obj);\r\n            });\r\n        }\r\n        obj.readyEventHandlersInstalled = true;\r\n    }\r\n} \r\n/**\r\n     * Return the javascript type in lowercase, ex array object\r\n     * @param {any} item\r\n     * @returns {string}\r\n*/\r\nexport function getDataType(item) {\r\n\r\n\treturn Object.prototype.toString.call(item).match(/\\s([a-zA-Z]+)/)[1].toLowerCase();\r\n}\r\n/**\r\n     * Returns a lower case element tag name ex div\r\n     * @param {(JQuery|HTMLElement)} element\r\n     * @returns {string}\r\n*/\r\nexport function elementTagName(element) {\r\n\tvar ele;\r\n\tif (element instanceof $) {\r\n\t\tele = element.prop('tagName');\r\n\t}else {\r\n\t\tele = element.tagName;\r\n\t}\r\n\r\n\treturn ele.toLowerCase();\r\n}\r\n/**\r\n     * Takes a functions arguments and converts it to an array\r\n     * @param {any[]} args\r\n     * @param {number} startAt\r\n     * @returns {any[]}\r\n*/\r\nexport function argsConverter(args, startAt) {\r\n\tvar giveBack = [],\r\n\t\tnumberToStartAt,\r\n\t\ttotal = args.length;\r\n\tfor (numberToStartAt = startAt || 0; numberToStartAt < total; numberToStartAt++){\r\n\t\tgiveBack.push(args[numberToStartAt]);\r\n\t  }\r\n\t  return giveBack;\r\n}\r\n/**\r\n     * Inserts an item or items starting at the passed index\r\n     * @param {any[]} array\r\n     * @param {number} index\r\n     * @returns {any[]}\r\n*/\r\nexport function arrayInsertAtIndex(array, index) {\r\n\t//all items past index will be inserted starting at index number\r\n\tvar arrayToInsert = Array.prototype.splice.apply(arguments, [2]);\r\n\tArray.prototype.splice.apply(array, [index, 0].concat(arrayToInsert));\r\n\treturn array;\r\n}\r\n/**\r\n     * Removes an item from index of the passed array\r\n     * @param {any[]} array\r\n     * @param {number} index\r\n     * @returns {any[]}\r\n*/\r\nexport function arrayRemoveAtIndex(array, index) {\r\n\tArray.prototype.splice.apply(array, [index, 1]);\r\n\treturn array;\r\n}\r\n/**\r\n     * Adds the beginning string to an email and encodes it for url use\r\n     * @param {string} acctName\r\n     * @returns {string}\r\n*/\r\nexport function encodeAccountName(acctName) {\r\n\tvar check = /^i:0\\#\\.f\\|membership\\|/,\r\n\t\tformattedName;\r\n\r\n\tif (check.test(acctName)) {\r\n\t\tformattedName = acctName;\r\n\t} else {\r\n\t\tformattedName = 'i:0#.f|membership|' + acctName;\r\n\t}\r\n\r\n\treturn encodeURIComponent(formattedName);\r\n}\r\n/**\r\n     * Returns a jquery promise that will resolve in the given time or default to 5 secs\r\n     * @param {number} time\r\n     * @returns {promise}\r\n*/\r\nexport function promiseDelay(time) {\r\n\tvar def = $.Deferred(),\r\n\t\tamount = time || 5000;\r\n\r\n\tsetTimeout(function() {\r\n\t\tdef.resolve();\r\n\t}, amount);\r\n\treturn def.promise();\r\n}\r\n/**Class creates a new instance of sesStorage */\r\nexport class sesStorage {\r\n\t//frontEnd to session Storage\r\n    /**\r\n     * Create a new sesStorage\r\n    */\r\n    constructor() {\r\n        this.storageAdaptor = sessionStorage;\r\n    }\r\n\ttoType(obj) {\r\n\t\treturn ({}).toString.call(obj).match(/\\s([a-z|A-Z]+)/)[1].toLowerCase();\r\n\t}\r\n    /**\r\n         * Retrieves an item from session storage\r\n         * @param {string} key\r\n         * @returns {any}\r\n    */\r\n\tgetItem(key) {\r\n\t\tvar item = this.storageAdaptor.getItem(key);\r\n\r\n\t\ttry {\r\n\t\t\titem = JSON.parse(item);\r\n\t\t} catch (e) {}\r\n\r\n\t\treturn item;\r\n\t}\r\n    /**\r\n         * Stores an item from session storage\r\n         * @param {string} key\r\n         * @param {any} value\r\n         * @returns {any}\r\n    */\r\n\tsetItem(key, value) {\r\n\t\tvar type = this.toType(value);\r\n\r\n\t\tif (/object|array/.test(type)) {\r\n\t\t\tvalue = JSON.stringify(value);\r\n\t\t}\r\n\r\n\t\tthis.storageAdaptor.setItem(key, value);\r\n\t}\r\n    /**\r\n         * Removes an item from session storage\r\n         * @param {string} key\r\n         * @returns {void}\r\n    */\r\n\tremoveItem(key) {\r\n\t\tthis.storageAdaptor.removeItem(key);\r\n\t}\r\n}\r\n/**Class creates a new pub sub object */\r\nexport class sublish {\r\n    /**\r\n         * Creates a new sublish\r\n    */\r\n    constructor() {\r\n        this.cache = {};\r\n    }\r\n    /**\r\n         * Publishes data to subscribers\r\n         * @param {string} id\r\n         * @returns {void}\r\n    */\r\n    publish(id, ...args) {\r\n        var ii,\r\n            total;\r\n        if (!this.cache[id]) {\r\n            this.cache[id] = [];\r\n        }\r\n        total = this.cache[id].length;\r\n        for (ii=0; ii < total; ii++) {\r\n            this.cache[id][ii].apply(this, args);\r\n        }\r\n\r\n    }\r\n    /**\r\n         * Subscribes a function to  an id\r\n         * for the fn the function will recieve whatever arguments are passed to publish\r\n         * so your parameters to the function should be whatever you are going to pass publish to the given id\r\n         * @param {string} id\r\n         * @param {function} fn\r\n         * @returns {void}\r\n    */\r\n    subscribe(id, fn) {\r\n        if (!this.cache[id]) {\r\n            this.cache[id] = [fn];\r\n        } else {\r\n            this.cache[id].push(fn);\r\n        }\r\n    }\r\n    /**\r\n         * Unsubscribes a function\r\n         * for the fn the function passed must be an exact reference to the function or it will not match\r\n         * @param {string} id\r\n         * @param {function} fn\r\n         * @returns {void}\r\n    */\r\n    unsubscribe(id, fn) {\r\n        var ii,\r\n            total;\r\n        if (!this.cache[id]) {\r\n            return;\r\n        }\r\n        total = this.cache[id].length;\r\n        for(ii = 0; ii < total; ii++){\r\n            if (this.cache[id][ii] === fn) {\r\n                this.cache[id].splice(ii, 1);\r\n            }\r\n        }\r\n    }\r\n    /**\r\n         * Clears the internal cache so all subscribed function all be removed\r\n         * @param {string} id\r\n         * @returns {void}\r\n    */\r\n    clear(id) {\r\n        if (!this.cache[id]) {\r\n            return;\r\n        }\r\n        this.cache[id] = [];\r\n    }\r\n}\r\n/**\r\n     * Creates a CSV file from the passed array\r\n     * @param {string} filename\r\n     * @param {string[][]} rows\r\n     * @returns {void}\r\n*/\r\nexport function exportToCSV(filename, rows) {\r\n    /*\r\n        rows should be\r\n        exportToCsv('export.csv', [\r\n            ['name','description'],\t\r\n            ['david','123'],\r\n            ['jona','\"\"'],\r\n            ['a','b'],\r\n\r\n        ])\r\n    \r\n    */\r\n    var csvFile = '';\r\n    for (var i = 0; i < rows.length; i++) {\r\n        csvFile += processRow(rows[i]);\r\n    }\r\n\r\n    var blob = new Blob([csvFile], { type: 'text/csv;charset=utf-8;' });\r\n    if (navigator.msSaveBlob) { // IE 10+\r\n        navigator.msSaveBlob(blob, filename);\r\n    } else {\r\n        var link = document.createElement(\"a\");\r\n        if (link.download !== undefined) { // feature detection\r\n            // Browsers that support HTML5 download attribute\r\n            var url = URL.createObjectURL(blob);\r\n            link.setAttribute(\"href\", url);\r\n            link.setAttribute(\"download\", filename);\r\n            link.style.visibility = 'hidden';\r\n            document.body.appendChild(link);\r\n            link.click();\r\n            document.body.removeChild(link);\r\n        }\r\n    }\r\n}\r\n/**\r\n     * Returns the SP pageObj that is on all SP pages\r\n     * @returns {object}\r\n*/\r\nexport function getPageInfo() {\r\n    \r\n    return window._spPageContextInfo;\r\n}\r\n/**\r\n     * Navigates the user to the url passed\r\n     * @param {string} url\r\n     * @returns {void}\r\n*/\r\nexport function spGotoUrl(url) {\r\n\r\n    STSNavigate(url);\r\n}\r\n/**\r\n     * Cleans the ajax search results to an array of objects\r\n     * @param {object[]} results\r\n     * @param {string[]} index\r\n     * @returns {object[]}\r\n*/\r\nexport function spSearchResultsCleaner(results, neededProps) {\r\n    if (!neededProps) {\r\n        // nothing to compare to\r\n        throw new Error('Need array to compare to.');\r\n    }\r\n    var ii,cleanProps,properties,totalItems;\r\n\r\n    return results.map(function(item) {\r\n        cleanProps = {};\r\n        properties = item.Cells;\r\n        totalItems = properties.length;\r\n\r\n        for (ii = 0; ii < totalItems; ii++) {\r\n            if(neededProps.indexOf(properties[ii].Key) !== -1){\r\n                cleanProps[properties[ii].Key] = properties[ii].Value;\r\n            }\r\n            continue;\r\n        }\r\n        return cleanProps;\r\n    });\r\n}\r\n/**\r\n     * Lets the script know if the SP page is in edit mode\r\n     * @returns {boolean}\r\n*/\r\nexport function pageEditModeTest() {\r\n\r\n    if ($('#MSOLayout_InDesignMode').val() === '1') {\r\n        return false;\r\n    } else{\r\n        return true;\r\n    }\r\n}\r\n/**\r\n     * Hides the ribbon at the top of an SP page\r\n     * @returns {void}\r\n*/\r\nexport function hideRibbon() {\r\n    \r\n    let ribbon = document.getElementById('s4-ribbonrow'),\r\n        currentHeight = parseInt(ribbon.style.height, 10);\r\n\r\n    ribbon.style.display = \"none\";\r\n    \r\n    if ( currentHeight !== 0 ) {\r\n        SelectRibbonTab(\"Ribbon.Read\", true);\r\n\r\n        setTimeout(hideRibbon, 300);\r\n    }\r\n}\r\nconst parse = function(params, pairs) {\r\n    var pair = pairs[0],\r\n        parts = pair.split('='),\r\n        key = decodeURIComponent(parts[0]),\r\n        value = decodeURIComponent(parts.slice(1).join('='));\r\n\r\n    // Handle multiple parameters of the same name\r\n    if (typeof params[key] === \"undefined\") {\r\n        params[key] = value;\r\n    } else {\r\n        params[key] = [].concat(params[key], value);\r\n    }\r\n\r\n    return pairs.length === 1 ? params : parse(params, pairs.slice(1));\r\n};\r\n/**\r\n     * Returns an object of the search properties in a url\r\n     * @returns {object}\r\n*/\r\nexport function URLparameters() {\r\n    let parastring = location.search;\r\n    return parastring.length === 0 ? {} : parse({}, parastring.substr(1).split('&'));\r\n}\r\n/**\r\n     * Returns a jquery promise that is resolved when the passed SP (only) script file is loaded\r\n     * @param {string} scriptName\r\n     * @returns {Promise}\r\n*/\r\nexport function waitForScriptsReady(scriptName) {\r\n    var def = $.Deferred();\r\n\r\n    ExecuteOrDelayUntilScriptLoaded(function() {\r\n        return def.resolve('Ready');\r\n    }, scriptName);\r\n\r\n    return def.promise();\r\n}\r\n/**\r\n     * Loops through all rows of the passed table\r\n     * @param {JQuery} table\r\n     * @param {function(JQuery, number):any} cb\r\n     * @returns {void}\r\n*/\r\nexport function tableRowLoop(table, cb) {\r\n\tvar rows = table.children('tbody').children('tr'),\r\n\t\ttotalRows = rows.length,\r\n\t\t$row,\r\n\t\tii;\r\n\r\n\tfor (ii=0; ii < totalRows; ii++) {\r\n\t\t$row = $(rows[ii]);\r\n\r\n\t\tif (cb.call(this, $row, ii) === false) {\r\n\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n}\r\n/**\r\n     * Returns a jquery promise that resolves when the script file is loaded, any script file\r\n     * @param {string} fileName\r\n     * @returns {Promise}\r\n*/\r\nexport function loadSPScript(fileName) {\r\n    //fileName example SP.Search.js\r\n    return $.getScript(`/_layouts/15/${fileName}`);\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/library.js"],"sourceRoot":""}