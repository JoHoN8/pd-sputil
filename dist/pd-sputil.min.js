!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?exports.pdsputil=t(require("jquery")):e.pdsputil=t(e.$)}(this,function(e){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){return!!PreSaveItem()&&((!e||!SPClientForms.ClientFormManager.SubmitClientForm(e))&&void WebForm_DoPostBackWithOptions(new WebForm_PostBackOptions(t,"",!0,"","",!1,!0)))}function a(e,t){var n={readyList:[],readyFired:!1,readyEventHandlersInstalled:!1};if("function"!=typeof e)throw new TypeError("callback for docReady(fn) must be a function");if(n.readyFired)return void setTimeout(function(){e(t)},1);n.readyList.push({fn:e,ctx:t}),"complete"===document.readyState||!document.attachEvent&&"interactive"===document.readyState?setTimeout(function(){P(n)},1):n.readyEventHandlersInstalled||(document.addEventListener?(document.addEventListener("DOMContentLoaded",function(){P(n)},!1),window.addEventListener("load",function(){P(n)},!1)):(document.attachEvent("onreadystatechange",R),window.attachEvent("onload",function(){P(n)})),n.readyEventHandlersInstalled=!0)}function i(e){return Object.prototype.toString.call(e).match(/\s([a-zA-Z]+)/)[1].toLowerCase()}function c(e){var t;return t=e instanceof C?e.prop("tagName"):e.tagName,t.toLowerCase()}function u(e,t){var n,r=[],o=e.length;for(n=t||0;n<o;n++)r.push(e[n]);return r}function s(e,t){var n=Array.prototype.splice.apply(arguments,[2]);return Array.prototype.splice.apply(e,[t,0].concat(n)),e}function l(e,t){return Array.prototype.splice.apply(e,[t,1]),e}function d(e){var t,n=/^i:0\#\.f\|membership\|/;return t=n.test(e)?e:"i:0#.f|membership|"+e,encodeURIComponent(t)}function f(e){return new Promise(function(t,n){var r=e||5e3;setTimeout(function(){t(!0)},r)})}function p(e,t){for(var n="",r=0;r<t.length;r++)n+=E(t[r]);var o=new Blob([n],{type:"text/csv;charset=utf-8;"});if(navigator.msSaveBlob)navigator.msSaveBlob(o,e);else{var a=document.createElement("a");if(void 0!==a.download){var i=URL.createObjectURL(o);a.setAttribute("href",i),a.setAttribute("download",e),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a)}}}function h(){return window._spPageContextInfo}function y(e){STSNavigate(e)}function m(e,t){if(!t)throw new Error("Need array to compare to.");var n,r,o,a;return e.map(function(e){for(r={},o=e.Cells,a=o.length,n=0;n<a;n++)-1!==t.indexOf(o[n].Key)&&(r[o[n].Key]=o[n].Value);return r})}function v(){return"1"!==C("#MSOLayout_InDesignMode").val()}function b(){var e=document.getElementById("s4-ribbonrow"),t=parseInt(e.style.height,10);e.style.display="none",0!==t&&(SelectRibbonTab("Ribbon.Read",!0),setTimeout(b,300))}function g(){var e=location.search;return 0===e.length?{}:F({},e.substr(1).split("&"))}function w(e){return new Promise(function(t,n){ExecuteOrDelayUntilScriptLoaded(function(){t(!0)},e)})}function S(e,t){var n,r,o=e.children("tbody").children("tr"),a=o.length;for(r=0;r<a&&(n=C(o[r]),!1!==t.call(this,n,r));r++);}function A(e){var t,n=h(),r=document.createElement("script");return t=n.siteAbsoluteUrl+"/_layouts/15/"+e,r.setAttribute("src",t),r.setAttribute("type","text/javascript"),document.head.appendChild(r),w(e)}function I(e){return/^[{|\\(]?[0-9a-fA-F]{8}[-]?([0-9a-fA-F]{4}[-]?){3}[0-9a-fA-F]{12}[\\)|}]?$/.test(e)}function L(){var e=window.location;return e.origin||(e.origin=e.protocol+"//"+e.hostname+(e.port?":"+e.port:"")),e.origin}Object.defineProperty(t,"__esModule",{value:!0}),t.spSaveForm=o,t.domReady=a,t.getDataType=i,t.elementTagName=c,t.argsConverter=u,t.arrayInsertAtIndex=s,t.arrayRemoveAtIndex=l,t.encodeAccountName=d,t.promiseDelay=f,n.d(t,"sesStorage",function(){return O}),n.d(t,"sublish",function(){return j}),t.exportToCSV=p,t.getPageInfo=h,t.spGotoUrl=y,t.spSearchResultsCleaner=m,t.pageEditModeTest=v,t.hideRibbon=b,t.URLparameters=g,t.waitForScriptsReady=w,t.tableRowLoop=S,t.loadSPScript=A,t.validGuid=I,t.getURLOrigin=L;var x=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),C=n(1),E=function(e){for(var t="",n=0;n<e.length;n++){var r=null===e[n]?"":e[n].toString();e[n]instanceof Date&&(r=e[n].toLocaleString());var o=r.replace(/"/g,'""');o.search(/("|,|\n)/g)>=0&&(o='"'+o+'"'),n>0&&(t+=","),t+=o}return t+"\r\n"},P=function(e){if(!e.readyFired){e.readyFired=!0;for(var t=0;t<e.readyList.length;t++)e.readyList[t].fn.call(window,e.readyList[t].ctx);e.readyList=[]}},R=function(){"complete"===document.readyState&&P()};!function(){try{Promise}catch(e){throw new Error("Promise API is required for spUtil library, please polyfill Promise to continue.")}}();var O=function(){function e(){r(this,e),this.storageAdaptor=sessionStorage}return x(e,[{key:"toType",value:function(e){return{}.toString.call(e).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()}},{key:"getItem",value:function(e){var t=this.storageAdaptor.getItem(e);try{t=JSON.parse(t)}catch(e){}return t}},{key:"setItem",value:function(e,t){/object|array/.test(this.toType(t))&&(t=JSON.stringify(t)),this.storageAdaptor.setItem(e,t)}},{key:"removeItem",value:function(e){this.storageAdaptor.removeItem(e)}}]),e}(),j=function(){function e(){r(this,e),this.cache={}}return x(e,[{key:"publish",value:function(e){var t,n;this.cache[e]||(this.cache[e]=[]),n=this.cache[e].length;for(var r=arguments.length,o=Array(r>1?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];for(t=0;t<n;t++)this.cache[e][t].apply(this,o)}},{key:"subscribe",value:function(e,t){this.cache[e]?this.cache[e].push(t):this.cache[e]=[t]}},{key:"unsubscribe",value:function(e,t){var n,r;if(this.cache[e])for(r=this.cache[e].length,n=0;n<r;n++)this.cache[e][n]===t&&this.cache[e].splice(n,1)}},{key:"clear",value:function(e){this.cache[e]&&(this.cache[e]=[])}}]),e}(),F=function e(t,n){var r=n[0],o=r.split("="),a=decodeURIComponent(o[0]),i=decodeURIComponent(o.slice(1).join("="));return void 0===t[a]?t[a]=i:t[a]=[].concat(t[a],i),1===n.length?t:e(t,n.slice(1))}},function(t,n){t.exports=e}])});